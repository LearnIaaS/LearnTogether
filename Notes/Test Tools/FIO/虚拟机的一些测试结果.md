# 虚拟机的一些测试结果

## A 一个混合

```shell
fio -filename=/mnt/nas0/file_fio -direct=1 -iodepth 1 -thread -rw=randrw -rwmixread=70 -ioengine=psync -bs=16k -size=500M -numjobs=30 -runtime=60 -group_reporting -name=mytest -ioscheduler=noop
```

```shell
mytest: (g=0): rw=randrw, bs=(R) 16.0KiB-16.0KiB, (W) 16.0KiB-16.0KiB, (T) 16.0KiB-16.0KiB, ioengine=psync, iodepth=1
...
fio-3.12
Starting 30 threads
mytest: Laying out IO file (1 file / 500MiB)
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
fio: io scheduler is not tunable
Jobs: 30 (f=30): [m(30)][4.9%][r=4016KiB/s,w=1776KiB/s][r=251,w=Jobs: 30 (f=30): [m(30)][6.6%][r=3859KiB/s,w=1713KiB/s][r=241,w=Jobs: 30 (f=30): [m(30)][8.2%][r=3991KiB/s,w=1731KiB/s][r=249,w=Jobs: 30 (f=30): [m(30)][9.8%][r=3916KiB/s,w=1694KiB/s][r=244,w=Jobs: 30 (f=30): [m(30)][11.5%][r=3792KiB/s,w=1568KiB/s][r=237,wJobs: 30 (f=30): [m(30)][13.1%][r=3475KiB/s,w=1473KiB/s][r=217,wJobs: 30 (f=30): [m(30)][14.8%][r=3523KiB/s,w=1601KiB/s][r=220,wJobs: 30 (f=30): [m(30)][16.4%][r=3635KiB/s,w=1377KiB/s][r=227,wJobs: 30 (f=30): [m(30)][18.0%][r=3584KiB/s,w=1504KiB/s][r=224,wJobs: 30 (f=30): [m(30)][19.7%][r=3315KiB/s,w=1697KiB/s][r=207,wJobs: 30 (f=30): [m(30)][21.3%][r=3971KiB/s,w=1953KiB/s][r=248,wJobs: 30 (f=30): [m(30)][23.0%][r=3680KiB/s,w=1696KiB/s][r=230,wJobs: 30 (f=30): [m(30)][24.6%][r=4144KiB/s,w=1744KiB/s][r=259,wJobs: 30 (f=30): [m(30)][26.2%][r=3952KiB/s,w=1488KiB/s][r=247,wJobs: 30 (f=30): [m(30)][27.9%][r=3683KiB/s,w=1665KiB/s][r=230,wJobs: 30 (f=30): [m(30)][29.5%][r=2800KiB/s,w=1280KiB/s][r=175,wJobs: 30 (f=30): [m(30)][31.1%][r=4196KiB/s,w=1649KiB/s][r=262,wJobs: 30 (f=30): [m(30)][32.8%][r=4404KiB/s,w=1681KiB/s][r=275,wJobs: 30 (f=30): [m(30)][34.4%][r=4592KiB/s,w=1600KiB/s][r=287,wJobs: 30 (f=30): [m(30)][36.1%][r=3715KiB/s,w=1473KiB/s][r=232,wJobs: 30 (f=30): [m(30)][37.7%][r=4256KiB/s,w=1664KiB/s][r=266,wJobs: 30 (f=30): [m(30)][39.3%][r=4164KiB/s,w=1585KiB/s][r=260,wJobs: 30 (f=30): [m(30)][41.0%][r=4152KiB/s,w=1747KiB/s][r=259,wJobs: 30 (f=30): [m(30)][42.6%][r=4116KiB/s,w=1665KiB/s][r=257,wJobs: 30 (f=30): [m(30)][44.3%][r=4228KiB/s,w=1569KiB/s][r=264,wJobs: 30 (f=30): [m(30)][45.9%][r=4027KiB/s,w=1550KiB/s][r=251,wJobs: 30 (f=30): [m(30)][47.5%][r=4212KiB/s,w=1921KiB/s][r=263,wJobs: 30 (f=30): [m(30)][49.2%][r=4080KiB/s,w=1808KiB/s][r=255,wJobs: 30 (f=30): [m(30)][50.8%][r=4104KiB/s,w=2004KiB/s][r=256,wJobs: 30 (f=30): [m(30)][52.5%][r=4096KiB/s,w=1696KiB/s][r=256,wJobs: 30 (f=30): [m(30)][54.1%][r=3552KiB/s,w=1328KiB/s][r=222,wJobs: 30 (f=30): [m(30)][55.7%][r=4308KiB/s,w=2210KiB/s][r=269,wJobs: 30 (f=30): [m(30)][57.4%][r=4160KiB/s,w=1664KiB/s][r=260,wJobs: 30 (f=30): [m(30)][59.0%][r=4308KiB/s,w=2002KiB/s][r=269,wJobs: 30 (f=30): [m(30)][60.7%][r=3824KiB/s,w=1616KiB/s][r=239,wJobs: 30 (f=30): [m(30)][62.3%][r=3939KiB/s,w=1793KiB/s][r=246,wJobs: 30 (f=30): [m(30)][63.9%][r=4368KiB/s,w=1616KiB/s][r=273,wJobs: 30 (f=30): [m(30)][65.6%][r=4212KiB/s,w=1825KiB/s][r=263,wJobs: 30 (f=30): [m(30)][67.2%][r=4136KiB/s,w=1747KiB/s][r=258,wJobs: 30 (f=30): [m(30)][68.9%][r=3948KiB/s,w=1998KiB/s][r=246,wJobs: 30 (f=30): [m(30)][70.5%][r=4440KiB/s,w=1987KiB/s][r=277,wJobs: 30 (f=30): [m(30)][72.1%][r=4400KiB/s,w=1680KiB/s][r=275,wJobs: 30 (f=30): [m(30)][73.8%][r=3920KiB/s,w=1968KiB/s][r=245,wJobs: 30 (f=30): [m(30)][75.4%][r=4192KiB/s,w=1872KiB/s][r=262,wJobs: 30 (f=30): [m(30)][77.0%][r=4164KiB/s,w=1601KiB/s][r=260,wJobs: 30 (f=30): [m(30)][78.7%][r=4004KiB/s,w=1761KiB/s][r=250,wJobs: 30 (f=30): [m(30)][80.3%][r=3920KiB/s,w=1936KiB/s][r=245,wJobs: 30 (f=30): [m(30)][82.0%][r=4004KiB/s,w=1825KiB/s][r=250,wJobs: 30 (f=30): [m(30)][83.6%][r=3984KiB/s,w=1984KiB/s][r=249,wJobs: 30 (f=30): [m(30)][85.2%][r=3923KiB/s,w=1601KiB/s][r=245,wJobs: 30 (f=30): [m(30)][86.9%][r=4164KiB/s,w=1777KiB/s][r=260,wJobs: 30 (f=30): [m(30)][88.5%][r=3996KiB/s,w=2029KiB/s][r=249,wJobs: 30 (f=30): [m(30)][90.2%][r=4164KiB/s,w=1729KiB/s][r=260,wJobs: 30 (f=30): [m(30)][91.8%][r=4256KiB/s,w=1888KiB/s][r=266,wJobs: 30 (f=30): [m(30)][93.4%][r=3859KiB/s,w=1649KiB/s][r=241,wJobs: 30 (f=30): [m(30)][95.1%][r=4352KiB/s,w=1680KiB/s][r=272,wJobs: 30 (f=30): [m(30)][96.7%][r=3943KiB/s,w=1571KiB/s][r=246,wJobs: 30 (f=30): [m(30)][98.4%][r=4016KiB/s,w=1504KiB/s][r=251,wJobs: 30 (f=30): [m(30)][100.0%][r=3795KiB/s,w=2146KiB/s][r=237,w=134 IOPS][eta 00m:00s]
mytest: (groupid=0, jobs=30): err= 0: pid=16763: Tue Aug 20 11:55:04 2019
  read: IOPS=250, BW=4002KiB/s (4098kB/s)(235MiB/60097msec)
    clat (usec): min=450, max=666855, avg=104104.81, stdev=84458.15
     lat (usec): min=450, max=666856, avg=104105.32, stdev=84458.14
    clat percentiles (msec):
     |  1.00th=[    8],  5.00th=[   24], 10.00th=[   34], 20.00th=[   45],
     | 30.00th=[   55], 40.00th=[   66], 50.00th=[   79], 60.00th=[   95],
     | 70.00th=[  117], 80.00th=[  148], 90.00th=[  207], 95.00th=[  275],
     | 99.00th=[  430], 99.50th=[  506], 99.90th=[  592], 99.95th=[  609],
     | 99.99th=[  634]
   bw (  KiB/s): min=   20, max=  351, per=3.32%, avg=132.86, stdev=50.69, samples=3593
   iops        : min=    1, max=   21, avg= 7.90, stdev= 3.21, samples=3593
  write: IOPS=107, BW=1725KiB/s (1766kB/s)(101MiB/60097msec)
    clat (usec): min=511, max=412330, avg=36442.65, stdev=30989.32
     lat (usec): min=511, max=412331, avg=36443.84, stdev=30989.37
    clat percentiles (usec):
     |  1.00th=[  1745],  5.00th=[  4883], 10.00th=[ 10945], 20.00th=[ 18744],
     | 30.00th=[ 23725], 40.00th=[ 27919], 50.00th=[ 32113], 60.00th=[ 35914],
     | 70.00th=[ 40633], 80.00th=[ 45876], 90.00th=[ 56361], 95.00th=[ 84411],
     | 99.00th=[139461], 99.50th=[238027], 99.90th=[362808], 99.95th=[400557],
     | 99.99th=[413139]
   bw (  KiB/s): min=   20, max=  288, per=4.28%, avg=73.78, stdev=44.12, samples=2786
   iops        : min=    1, max=   18, avg= 4.21, stdev= 2.79, samples=2786
  lat (usec)   : 500=0.01%, 750=0.06%, 1000=0.04%
  lat (msec)   : 2=0.39%, 4=0.99%, 10=2.40%, 20=5.45%, 50=33.67%
  lat (msec)   : 100=29.73%, 250=22.73%, 500=4.17%, 750=0.36%
  cpu          : usr=0.00%, sys=0.23%, ctx=21664, majf=0, minf=37
  IO depths    : 1=100.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, >=64=0.0%
     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
     issued rwts: total=15032,6479,0,0 short=0,0,0,0 dropped=0,0,0,0
     latency   : target=0, window=0, percentile=100.00%, depth=1

Run status group 0 (all jobs):
   READ: bw=4002KiB/s (4098kB/s), 4002KiB/s-4002KiB/s (4098kB/s-4098kB/s), io=235MiB (246MB), run=60097-60097msec
  WRITE: bw=1725KiB/s (1766kB/s), 1725KiB/s-1725KiB/s (1766kB/s-1766kB/s), io=101MiB (106MB), run=60097-60097msec

Disk stats (read/write):
    dm-0: ios=15012/6502, merge=0/0, ticks=1558360/237046, in_queue=1798659, util=100.00%, aggrios=15032/6513, aggrmerge=0/2, aggrticks=1563987/237753, aggrin_queue=1801790, aggrutil=99.97%
  sda: ios=15032/6513, merge=0/2, ticks=1563987/237753, in_queue=1801790, util=99.97%
```

## B 个人笔记本电脑

```shell
[root@artist test04]# ./run_fio.py
fio --ioengine=libaio --direct=1 --sync=1 --thread=1 --numjobs=1 --iodepth=1 --runtime=60 --bs=4M --size=500M --rw=write --time_based=1 --name=test1 --filename=/mnt/nas0/file1 --output-format=json
running...
fio success
run success:

read:
IOPS=0.0, BW=0MiB/s
slat(usec):min=0, max=0, mean=0.0, stddev=0.0
clat(nsec):min=0, max=0, mean=0.0, stddev=0.0

write:
IOPS=24.73086, BW=101297MiB/s
slat(usec):min=897467, max=10787459, mean=2228262.93059, stddev=1425737.44067
clat(nsec):min=5120735, max=391104699, mean=38195598.9933, stddev=58944156.1657

cpu:
usr=0.378302%, sys=5.377885%, ctx=1487, majf=0, minf=4
IO depths:
1=100.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, >=64=0.0%

```

## C VM虚拟机

```python
[root@artist test]# ./run_fio.py
fio --ioengine=libaio --direct=1 --sync=1 --thread=1 --numjobs=1 --iodepth=1 --runtime=60 --bs=4M --size=500M --rw=write --time_based=1 --name=test1 --filename=/mnt/nas0/file1 --output-format=json
running...
fio success
run success:

read:
IOPS=0.0, BW=0MiB/s
slat(usec):min=0, max=0, mean=0.0, stddev=0.0
clat(nsec):min=0, max=0, mean=0.0, stddev=0.0

write:
IOPS=16.177402, BW=66262MiB/s
slat(usec):min=972692, max=8377078, mean=2723076.84346, stddev=1274683.77037
clat(nsec):min=25977183, max=268978591, mean=59078104.0113, stddev=24986765.849

cpu:
usr=0.099965%, sys=4.561737%, ctx=973, majf=0, minf=9

IO depths:
1=100.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, >=64=0.0%
```

## D 公司虚拟机

```shell
fio --ioengine=libaio --direct=1 --sync=1 --thread=1 --numjobs=1 --iodepth=1 --runtime=60 --bs=4M --size=500M --rw=write --time_based=1 --name=test1 --filename=/mnt/nas0/file1 --output-format=json
running...
fio success
run success:

read:
IOPS=0.0, BW=0MiB/s
slat(usec):min=0, max=0, mean=0.0, stddev=0.0
clat(nsec):min=0, max=0, mean=0.0, stddev=0.0

write:
IOPS=8.813729, BW=36101MiB/s
slat(usec):min=357808, max=2702827, mean=660721.438563, stddev=197837.41909
clat(nsec):min=31095414, max=227549856, mean=112783271.737, stddev=49922500.6761

cpu:
usr=0.363218%, sys=0.249921%, ctx=532, majf=0, minf=5

IO depths:
1=100.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, >=64=0.0%
```

